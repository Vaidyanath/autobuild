#!/usr/bin/make -f

export DH_VERBOSE=1

SHELL := sh -e

DESTDIR := $(CURDIR)/debian/rjil-cicd
PROJECTS := $(filter-out debian, $(wildcard *))

%:
	dh $@ --with python2

override_dh_auto_clean:
	dh_auto_clean
	for PROJ in $(PROJECTS); \
	do \
		#TODO: Need to investigate the equivalent of `make -C` in setuptools \
		cd $${PROJ}; \
		echo "Cleaning project $${PROJ}"; \
		python setup.py clean; \
		rm -rf build; \
		rm -rf $${PROJ}-*egg-info; \
		cd ..; \
	done

override_dh_auto_build:
	for PROJ in $(PROJECTS); \
	do \
		cd $${PROJ}; \
		echo "Building project $${PROJ}"; \
		python setup.py build; \
		cd ..; \
	done

override_dh_auto_install:
	for PROJ in $(PROJECTS); \
	do \
		cd $${PROJ}; \
		echo "Installing project $${PROJ}"; \
		python setup.py install; \
		cd ..; \
	done

